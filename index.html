<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src ="./socket.io.js"></script>
</head>
<body>
    <h1>test websocket</h1>
    <input type="text" id="sendTxt">
    <button type="button" id="sendBtn">发送</button>
    <p id="recv"></p>

    <script>
        var socket = io('ws://web1.shuiqian.cc:8001');

        function showMessage(str,type){
            var div =document.createElement("div");
            div.innerHTML = str;
            if(type =="enter"){
                div.style.color="blue";
            }else if(type =="leave"){
                div.style.color="red";
            }
            document.body.appendChild(div);
        }

        socket.on("enter",function(data){
            showMessage(data,"enter");
        })
        socket.on("message",function(data){
            showMessage(data,"message");
        });
        socket.on("leave",function(data){
            showMessage(data,"leave");
        });
        document.getElementById("sendBtn").onclick=function(){
            var text = document.getElementById("sendTxt").value;
            console.log(text);
            if(text){
                socket.emit('message', text);
                document.getElementById("sendTxt").value ="";
            }
        };
//        socket.onopen = function(){
//            console.log("websocket open");
//            document.getElementById("recv").innerHTML = "正在连接";
//        }
//        websocket.onclose= function(){
//            console.log("webscocket closed");
//        }
//        websocket.onmessage = function(e){
//            console.log(e);
//            document.getElementById("recv").innerHTML = e.data;
//        }
//        document.getElementById("sendBtn").onclick=function(){
//            var text = document.getElementById("sendTxt").value;
//            console.log(text);
//            websocket.send(text);
//        }
    </script>

</body>
</html>